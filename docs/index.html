<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lyftiv - Suivi S√©ance Musculation</title>
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    
    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    
    <!-- Manifest & Metadata -->
    <link rel="manifest" href="manifest.json">
    <meta name="robots" content="noindex, nofollow">
    
    <!-- Main Stylesheet -->
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <div class="main-container">

        <!-- En-t√™te de l'application -->
        <header class="app-header">
            <h1>
                <img src="public/images/logo.png" alt="Logo Lyftiv" class="lyftiv-logo">
                Lyftiv
            </h1>
            <div class="theme-switcher">
                <button id="themeToggleBtn" class="btn btn--ghost" aria-label="Changer de th√®me">üåô</button>
            </div>
        </header>

        <!-- Contr√¥les principaux de la s√©ance -->
        <fieldset class="controls-fieldset">
            <legend class="u-visually-hidden">Contr√¥les de la s√©ance</legend>
            <div class="controls">
                <div class="form-field">
                    <label for="sessionSelect" class="form-field__label"><strong>S√©ance :</strong></label>
                    <select id="sessionSelect" class="form-field__select" aria-label="S√©lectionner une s√©ance d'entra√Ænement"></select>
                </div>
                <button class="btn btn--outline" id="createNewSessionTypeBtn" aria-label="Cr√©er une nouvelle s√©ance">Nouvelle S√©ance</button>
                <button class="btn btn--outline btn--danger" id="deleteCurrentSessionBtn" aria-label="Supprimer la s√©ance actuelle" title="Supprimer la s√©ance actuelle (personnalis√©e)">
                    <i class="fas fa-trash-alt" aria-hidden="true"></i>
                    <span>Supprimer</span>
                </button>
            </div>
        </fieldset>

        <!-- Barre de progression -->
        <div class="progress-bar" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" id="progressBar">
          <div class="progress-fill" id="progressFill"></div>
        </div>
        
        <!-- Conteneur pour la liste des exercices -->
        <div id="exerciseListContainer" class="exercise-list-container">
            <!-- Les exercices seront inject√©s ici par le JS -->
        </div>
        
        <!-- Section pour ajouter un exercice -->
        <section class="add-exercise-section" id="addExerciseSection">
            <div class="form-field">
                <label for="customExercise" class="u-visually-hidden">Ajouter un exercice</label>
                <input type="text" id="customExercise" class="form-field__input" placeholder="Nom de l'exercice" aria-label="Nom de l'exercice personnalis√©">
                <div id="autocompleteSuggestions" class="u-hidden" role="listbox" aria-label="Suggestions d'exercices"></div>
            </div>
            <button class="btn btn--success" id="addExerciseBtn" aria-label="Ajouter l'exercice">
                <i class="fas fa-plus" aria-hidden="true"></i>
                <span>Ajouter</span>
            </button>
        </section>

        <!-- Grille r√©capitulative -->
        <section class="summary-grid">
            <div class="summary-card">
                <h3><i class="fas fa-weight-hanging" aria-hidden="true"></i> Tonnage Total</h3>
                <div class="summary-card__value" id="totalTonnage" aria-live="polite">0 kg</div>
            </div>
            <div class="summary-card">
                <h3><i class="fas fa-chart-line" aria-hidden="true"></i> Semaine Pr√©c√©dente</h3>
                <div class="form-field">
                    <label for="previousWeek" class="u-visually-hidden">Tonnage de la semaine pr√©c√©dente</label>
                    <input type="text" id="previousWeek" class="form-field__input" placeholder="Tonnage Pr√©c. (kg)" aria-label="Tonnage de la semaine pr√©c√©dente">
                </div>
            </div>
            <div class="summary-card">
                <h3><i class="fas fa-arrow-up" aria-hidden="true"></i> Progression</h3>
                <div class="summary-card__value" id="delta" aria-live="polite">0 kg</div>
            </div>
            <div class="summary-card">
                <h3><i class="fas fa-clock" aria-hidden="true"></i> Temps Total</h3>
                <div class="summary-card__value" id="totalTime" aria-live="polite">00:00:00</div>
                <button id="toggleWorkoutTimerBtn" class="btn btn--secondary" aria-label="Mettre en pause ou reprendre le minuteur">
                    <span id="timerPlayPauseIcon" aria-hidden="true">‚èØÔ∏è</span>
                    <span id="timerPlayPauseText">Pause</span>
                </button>
            </div>
        </section>

        <!-- Section des notes -->
        <section id="sessionNotesSection">
            <div class="form-field">
                <label for="sessionNotes" class="form-field__label"><strong>Notes de S√©ance :</strong></label>
                <textarea id="sessionNotes" class="form-field__textarea" placeholder="Ajouter des notes sur la s√©ance..." aria-label="Notes de s√©ance"></textarea>
            </div>
        </section>
        
        <!-- Boutons d'action principaux -->
        <footer class="page-footer">
            <div class="action-buttons">
              <button class="btn btn--success" id="finishSessionBtn" aria-label="Terminer et Sauvegarder la s√©ance"><i class="fas fa-save" aria-hidden="true"></i> Terminer & Sauvegarder</button>
              <button class="btn btn--primary" id="viewHistoryBtn" aria-label="Voir l'historique"><i class="fas fa-book" aria-hidden="true"></i> Historique</button>
              <button class="btn btn--primary" id="plateCalculatorBtn" aria-label="Ouvrir les calculateurs"><i class="fas fa-calculator" aria-hidden="true"></i> Calculateurs</button>
            </div>
    
            <div class="action-buttons">
                <button class="btn btn--info" id="exportBtn" aria-label="Exporter les donn√©es"><i class="fas fa-file-export" aria-hidden="true"></i> Exporter</button>
                <button class="btn btn--info" id="importBtn" aria-label="Importer les donn√©es"><i class="fas fa-file-import" aria-hidden="true"></i> Importer</button>
            </div>
        </footer>
        <input type="file" id="importFile" class="u-hidden" accept=".json,.csv" aria-label="Fichier d'importation">
    </div>
    
    <!-- Conteneur de notifications -->
    <div id="notification-container" aria-live="polite" aria-atomic="true"></div>
    
    <!-- Banni√®re d'installation PWA -->
    <div id="pwaInstallPrompt" class="u-hidden" role="dialog" aria-modal="true" aria-labelledby="pwaInstallTitle">
        <span id="pwaInstallTitle" style="font-weight: 600;">Ajoutez Lyftiv √† votre √©cran d'accueil !</span>
        <button id="installPwaBtn" class="btn btn--primary">Installer</button>
        <button id="closePwaPrompt" class="btn btn--ghost" aria-label="Fermer le message d'installation">&times;</button>
    </div>

    <!-- Modal: Historique -->
    <div id="historyModal" class="modal__overlay u-hidden" role="dialog" aria-modal="true" aria-labelledby="historyModalTitle">
      <div class="modal__content">
          <div class="modal__header">
              <h2 id="historyModalTitle" class="modal__title">Historique des S√©ances</h2>
              <button id="closeHistoryModal" class="modal__close-btn btn btn--ghost" aria-label="Fermer le modal historique">&times;</button>
          </div>
          <div class="modal__body">
              <div id="historyList"></div>
          </div>
      </div>
    </div>

    <!-- Modal: Nouvelle S√©ance -->
    <div id="newSessionModal" class="modal__overlay u-hidden" role="dialog" aria-modal="true" aria-labelledby="newSessionModalTitle">
        <div class="modal__content">
            <div class="modal__header">
                <h2 id="newSessionModalTitle" class="modal__title">Cr√©er une Nouvelle S√©ance</h2>
                <button id="closeNewSessionModal" class="modal__close-btn btn btn--ghost" aria-label="Fermer le modal de nouvelle s√©ance">&times;</button>
            </div>
            <div class="modal__body">
                <div class="form-field">
                    <label for="newSessionNameInput" class="u-visually-hidden">Nom de la nouvelle s√©ance</label>
                    <input type="text" id="newSessionNameInput" class="form-field__input" placeholder="Nom de la nouvelle s√©ance" aria-label="Nom de la nouvelle s√©ance">
                    <div id="newSessionNameError" class="form-field__error-message"></div>
                </div>
            </div>
            <div class="modal__footer">
                <button class="btn btn--outline" id="cancelNewSessionBtn"><i class="fas fa-times" aria-hidden="true"></i> Annuler</button>
                <button class="btn btn--success" id="createNewSessionBtn"><i class="fas fa-check" aria-hidden="true"></i> Cr√©er</button>
            </div>
        </div>
    </div>

    <!-- Modal: Options de chargement -->
    <div id="loadOptionsModal" class="modal__overlay u-hidden" role="dialog" aria-modal="true" aria-labelledby="loadOptionsModalTitle">
      <div class="modal__content">
          <div class="modal__header">
              <h2 id="loadOptionsModalTitle" class="modal__title">Options de Chargement</h2>
              <button id="closeLoadOptionsModal" class="modal__close-btn btn btn--ghost" aria-label="Fermer le modal d'options de chargement">&times;</button>
          </div>
          <div class="modal__body">
              <p>Comment utiliser la s√©ance "<strong id="loadSessionName"></strong>" ?</p>
          </div>
          <div class="modal__footer">
              <button class="btn btn--primary" id="openNewSessionBtn"><i class="fas fa-folder-open" aria-hidden="true"></i> Ouvrir</button>
              <button class="btn btn--secondary" id="appendToCurrentSessionBtn"><i class="fas fa-plus-square" aria-hidden="true"></i> Ajouter</button>
          </div>
      </div>
    </div>

    <!-- Modal: Calculateurs -->
    <div id="plateCalculatorModal" class="modal__overlay u-hidden" role="dialog" aria-modal="true" aria-labelledby="plateCalcModalTitle">
        <div class="modal__content">
            <button id="closePlateCalculatorModal" class="modal__close-btn btn btn--ghost" aria-label="Fermer le modal du calculateur de plaques">&times;</button>
            <div class="modal-tabs"> <!-- NOTE: Tab styles are not in the provided CSS, keeping original structure -->
                <button class="modal-tab-btn active" id="plateCalcTab" aria-controls="plateCalcContent" role="tab" aria-selected="true">Calculateur de Plaques</button>
                <button class="modal-tab-btn" id="goalCalcTab" aria-controls="goalCalcContent" role="tab" aria-selected="false">Objectifs d'Entra√Ænement</button>
            </div>
            
            <div id="plateCalcContent" class="modal-tab-content" role="tabpanel" aria-labelledby="plateCalcTab">
                <div class="modal__header">
                    <h2 id="plateCalcModalTitle" class="modal__title">Calculateur de Plaques</h2>
                </div>
                <div class="modal__body">
                    <div class="form-field">
                        <label for="targetWeightInput" class="u-visually-hidden">Poids cible (kg)</label>
                        <input type="number" id="targetWeightInput" class="form-field__input" min="0" placeholder="Poids cible (kg)" aria-label="Poids cible">
                        <div id="targetWeightError" class="form-field__error-message"></div>
                    </div>
                    <div class="form-field">
                        <label for="barbellWeightInput" class="u-visually-hidden">Poids barre (kg)</label>
                        <input type="number" id="barbellWeightInput" class="form-field__input" min="0" placeholder="Poids barre (kg)" aria-label="Poids de la barre">
                        <div id="barbellWeightError" class="form-field__error-message"></div>
                    </div>
                    <div id="platesResult" style="text-align: left; margin-top: var(--spacing-4);"></div>
                </div>
            </div>

            <div id="goalCalcContent" class="modal-tab-content u-hidden" role="tabpanel" aria-labelledby="goalCalcTab">
                <div class="modal__header">
                    <h2 class="modal__title">Objectifs d'Entra√Ænement</h2>
                </div>
                <div class="modal__body">
                    <div class="form-field">
                        <label for="oneRmInput" class="u-visually-hidden">Votre 1RM (kg)</label>
                        <input type="number" id="oneRmInput" class="form-field__input" min="0" placeholder="Votre 1RM (kg)" aria-label="Votre 1RM">
                        <div id="oneRmError" class="form-field__error-message"></div>
                    </div>
                    <div id="goalResultsContainer"></div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Modal: √âdition Rapide -->
    <div id="quickEditModal" class="modal__overlay u-hidden" role="dialog" aria-modal="true" aria-labelledby="quickEditModalTitle">
      <div class="modal__content">
          <div class="modal__header">
              <h2 id="quickEditModalTitle" class="modal__title">√âdition Rapide</h2>
              <button id="closeQuickEditModal" class="modal__close-btn btn btn--ghost" aria-label="Fermer le modal d'√©dition rapide">&times;</button>
          </div>
          <div class="modal__body">
              <p>Appliquer √† toutes les s√©ries de : <strong id="quickEditExerciseName"></strong></p>
              <div class="form-field">
                  <label for="quickEditWeight" class="u-visually-hidden">Poids (kg)</label>
                  <input type="text" id="quickEditWeight" class="form-field__input" placeholder="Poids (kg)" aria-label="Poids pour √©dition rapide">
                  <div id="quickEditWeightError" class="form-field__error-message"></div>
              </div>
              <div class="form-field">
                  <label for="quickEditReps" class="u-visually-hidden">Reps</label>
                  <input type="text" id="quickEditReps" class="form-field__input" placeholder="Reps" aria-label="R√©p√©titions pour √©dition rapide">
                  <div id="quickEditRepsError" class="form-field__error-message"></div>
              </div>
          </div>
          <div class="modal__footer">
              <button class="btn btn--success" id="applyQuickEditBtn" style="width: 100%;"><i class="fas fa-check-circle" aria-hidden="true"></i> Appliquer</button>
          </div>
      </div>
    </div>

    <!-- Navigation inf√©rieure pour mobile -->
    <nav class="bottom-nav">
        <button class="bottom-nav__button" id="bottomAddExerciseBtn" aria-label="Ajouter un exercice">
            <i class="fas fa-plus-circle bottom-nav__icon" aria-hidden="true"></i>
            <span>Exercice</span>
        </button>
        <button class="bottom-nav__button" id="bottomNotesBtn" aria-label="Notes de s√©ance">
            <i class="fas fa-clipboard bottom-nav__icon" aria-hidden="true"></i>
            <span>Notes</span>
        </button>
        <button class="bottom-nav__button" id="bottomViewHistoryBtn" aria-label="Historique">
            <i class="fas fa-history bottom-nav__icon" aria-hidden="true"></i>
            <span>Historique</span>
        </button>
        <button class="bottom-nav__button" id="bottomPlateCalculatorBtn" aria-label="Calculateurs">
            <i class="fas fa-calculator bottom-nav__icon" aria-hidden="true"></i>
            <span>Calculs</span>
        </button>
        <button class="bottom-nav__button" id="bottomFinishSessionBtn" aria-label="Terminer la s√©ance">
            <i class="fas fa-flag-checkered bottom-nav__icon" aria-hidden="true"></i>
            <span>Terminer</span>
        </button>
    </nav>

    <script src="main.js" type="module" defer></script>
    
</body>
</html>
